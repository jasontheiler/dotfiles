# See: http://man.openbsd.org/OpenBSD-current/man1/tmux.1

if-shell "[ -z \"${WSL_DISTRO_NAME}\" ]" {
    set-option -g default-terminal "xterm-kitty"
    # set-option -as terminal-overrides ",*:smulx=\E[4\:%p1%dm" # Enables support for undercurls.
    # set-option -sa terminal-overrides ",*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m" # Enables support for underline colors.
}
set-option -ga terminal-features ",xterm-256color:RGB"
set-option -g mode-keys vi
set-option -g mouse on
set-option -g escape-time 10
set-option -g display-time 2000
set-option -g set-titles on
set-option -g set-titles-string "#{s|${HOME}|~|:session_path}/"
set-option -g detach-on-destroy off

set-option -g message-style "fg=yellow,bg=terminal"

set-option -g status 2
set-option -g status-keys vi
set-option -g status-interval 1
set-option -g status-format[0] "#[fg=#130F0F]#{s| |‚îÅ|:#{p512:}}"
set-option -g status-format[1] "#[align=left range=left #{E:status-left-style}]#[push-default]#{T;=/#{status-left-length}:status-left}#[pop-default]#[norange default]#[list=on align=#{status-justify}]#[list=left-marker]<#[list=right-marker]>#[list=on]#{W:#[range=window|#{window_index} #{E:window-status-style}#{?#{&&:#{window_last_flag},#{!=:#{E:window-status-last-style},default}}, #{E:window-status-last-style},}#{?#{&&:#{window_bell_flag},#{!=:#{E:window-status-bell-style},default}}, #{E:window-status-bell-style},#{?#{&&:#{||:#{window_activity_flag},#{window_silence_flag}},#{!=:#{E:window-status-activity-style},default}}, #{E:window-status-activity-style},}}]#[push-default]#{T:window-status-format}#[pop-default]#[norange default]#{?window_end_flag,,#{window-status-separator}},#[range=window|#{window_index} list=focus #{?#{!=:#{E:window-status-current-style},default},#{E:window-status-current-style},#{E:window-status-style}}#{?#{&&:#{window_last_flag},#{!=:#{E:window-status-last-style},default}}, #{E:window-status-last-style},}#{?#{&&:#{window_bell_flag},#{!=:#{E:window-status-bell-style},default}}, #{E:window-status-bell-style},#{?#{&&:#{||:#{window_activity_flag},#{window_silence_flag}},#{!=:#{E:window-status-activity-style},default}}, #{E:window-status-activity-style},}}]#[push-default]#{T:window-status-current-format}#[pop-default]#[norange list=on default]#{?window_end_flag,,#{window-status-separator}}}#[nolist align=right range=right #{E:status-right-style}]#[push-default]#{T;=/#{status-right-length}:status-right}#[pop-default]#[norange default]"
set-option -g status-style bg=terminal
set-option -g status-left "#[fg=cyan]#{s|${HOME}|~|:session_path}/#[fg=default] "
set-option -g status-left-length 0
set-option -g status-right "#{?client_prefix,^a  ,}%a %b %d | %H:%M"
set-option -g status-right-length 0

set-option -g base-index 1
set-option -g renumber-windows on
set-option -g window-status-format "#[fg=#75615B] #{window_index} #{window_name} "
set-option -g window-status-current-format " #{window_index} #{window_name} "
set-option -g window-status-separator ""

set-option -g pane-base-index 1
set-option -g pane-border-lines heavy
set-option -g pane-border-style fg="#130F0F"
set-option -g pane-active-border-style fg="#130F0F"
set-option -g main-pane-width 70%

set-option -g popup-border-lines heavy
set-option -g popup-border-style fg="#BDAEC3"

unbind-key C-b
set-option -g prefix C-a
set-option -g prefix2 M-a

bind-key s split-window -ve
bind-key v split-window -he

bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

bind-key -r C-h resize-pane -L
bind-key -r C-j resize-pane -D
bind-key -r C-k resize-pane -U
bind-key -r C-l resize-pane -R

bind-key w run-shell "tmuxion last"

bind-key t display-popup -E -w 75% -h 80%
bind-key f display-popup -E -w 75% -h 80% "fish -c \"tmux_popup_ranger\""
bind-key F display-popup -E -w 75% -h 80% "fish -c \"tmux_popup_ranger --reset\""
bind-key g display-popup -E -w 75% -h 80% "lazygit"
bind-key b display-popup -E -w 75% -h 80% "btm"
bind-key C-s display-popup -E -w 64 -h 24 "tmuxion select"
bind-key M-s display-popup -E -w 64 -h 24 "tmuxion select"

bind-key C-r source ${HOME}/.tmux.conf\; display "Config reloaded"
bind-key M-r source ${HOME}/.tmux.conf\; display "Config reloaded"
